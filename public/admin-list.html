<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Admin List | Sadri Villa</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{font-family:Arial;background:#eef2ff;padding:20px}
h2{margin-bottom:14px}

.nav{
  display:flex;gap:10px;margin-bottom:16px;flex-wrap:wrap
}
.nav button{
  padding:10px 16px;border:none;border-radius:14px;
  background:linear-gradient(135deg,#38bdf8,#0ea5e9);
  color:#fff;font-weight:600;cursor:pointer;
  box-shadow:0 10px 25px rgba(56,189,248,.35)
}

table{
  width:100%;background:#fff;border-radius:18px;
  border-collapse:collapse;overflow:hidden;
  box-shadow:0 18px 40px rgba(0,0,0,.12)
}
th,td{padding:12px;border-bottom:1px solid #e5e7eb;font-size:14px}
th{background:#f8fafc;text-align:left}
.uid{
  font-family:monospace;font-size:12px;color:#475569;
  cursor:pointer
}
.uid:hover{text-decoration:underline}
.badge{
  background:#16a34a;color:#fff;
  padding:4px 10px;border-radius:999px;font-size:12px
}
</style>
</head>

<body>

<h2>üë• Admin Users</h2>

<div class="nav">
  <button onclick="location.href='admin-dashboard.html'">‚Üê Dashboard</button>
  <button onclick="location.href='add-admin.html'">‚ûï Add Admin</button>
</div>

<table>
<thead>
<tr>
  <th>Name</th>
  <th>Email</th>
  <th>Phone</th>
  <th>UID (click to copy)</th>
  <th>Status</th>
</tr>
</thead>
<tbody id="list"></tbody>
</table>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
import { getAuth,onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";
import { getFirestore,collection,getDocs,doc,getDoc } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

/* FIREBASE */
const app = initializeApp({
  apiKey:"AIzaSyC7gkT4F_dRJpWfef12y6cwV3F2PTMJ6fY",
  authDomain:"sadri-villa-14c06.firebaseapp.com",
  projectId:"sadri-villa-14c06"
});
const auth = getAuth(app);
const db = getFirestore(app);
const list = document.getElementById("list");

/* AUTH GUARD */
onAuthStateChanged(auth, async user=>{
  if(!user) return location.href="login.html";

  const token = await user.getIdTokenResult(true);
  if(!token.claims.admin){
    alert("Admin access only");
    return location.href="dashboard.html";
  }

  loadAdmins();
});

/* LOAD ADMINS */
async function loadAdmins(){
  list.innerHTML="";
  const snap = await getDocs(collection(db,"users"));

  snap.forEach(d=>{
    const u = d.data();
    if(u.role === "admin"){
      list.innerHTML += `
        <tr>
          window.viewProfile = uid => {
  location.href = `profile.html?uid=${uid}`;
};
          <td>${u.email || "-"}</td>
          <td>${u.phone || "-"}</td>
          <td class="uid" onclick="copy('${d.id}')">${d.id}</td>
          <td><span class="badge">Admin</span></td>
        </tr>
      `;
    }
  });
}

/* COPY UID */
window.copy = uid => {
  navigator.clipboard.writeText(uid);
  alert("UID copied");
};
</script>

</body>
</html>
