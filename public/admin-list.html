<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Admin List ‚Äì Sadri Villa</title>
<meta name="viewport" content="width=device-width,initial-scale=1">

<style>
body{
  font-family:Arial;
  background:#eef2ff;
  padding:20px
}
.topbar{
  display:flex;
  align-items:center;
  gap:12px;
  margin-bottom:14px
}
.btn{
  padding:10px 18px;
  border:none;
  border-radius:14px;
  cursor:pointer;
  font-weight:600;
  background:rgba(56,189,248,.85);
  color:#fff;
  backdrop-filter:blur(10px);
  box-shadow:0 10px 25px rgba(56,189,248,.35)
}
h2{margin:0}

table{
  width:100%;
  background:#fff;
  border-radius:18px;
  border-collapse:collapse;
  overflow:hidden;
  box-shadow:0 18px 40px rgba(0,0,0,.12)
}
th,td{
  padding:14px;
  border-bottom:1px solid #e5e7eb;
  font-size:14px
}
th{background:#f8fafc;text-align:left}
tr:hover{
  background:#f1f5ff;
  cursor:pointer
}
.uid{
  font-family:monospace;
  font-size:12px;
  color:#475569
}
.badge{
  padding:4px 10px;
  border-radius:999px;
  background:#16a34a;
  color:#fff;
  font-size:12px
}
.copy{
  font-size:12px;
  color:#0ea5e9;
  cursor:pointer;
  margin-left:6px
}
</style>
</head>

<body>

<div class="topbar">
  <button class="btn" onclick="history.back()">‚Üê Back</button>
  <h2>üë• Admin Users</h2>
</div>

<table>
<thead>
<tr>
  <th>Name</th>
  <th>Email</th>
  <th>Phone</th>
  <th>UID</th>
  <th>Status</th>
</tr>
</thead>
<tbody id="list"></tbody>
</table>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
import { getAuth,onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";
import { getFirestore,collection,getDocs,doc,getDoc } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

/* FIREBASE */
const app=initializeApp({
  apiKey:"AIzaSyC7gkT4F_dRJpWfef12y6cwV3F2PTMJ6fY",
  authDomain:"sadri-villa-14c06.firebaseapp.com",
  projectId:"sadri-villa-14c06"
});
const auth=getAuth(app);
const db=getFirestore(app);
const list=document.getElementById("list");

/* AUTH GUARD */
onAuthStateChanged(auth, async user=>{
  if(!user) return location.href="login.html";

  const token=await user.getIdTokenResult(true);
  if(!token.claims.admin){
    alert("Admin only");
    return location.href="dashboard.html";
  }
  loadAdmins();
});

/* LOAD ADMINS */
async function loadAdmins(){
  const snap=await getDocs(collection(db,"admins"));

  for(const a of snap.docs){
    const uSnap=await getDoc(doc(db,"users",a.id));
    const u=uSnap.exists()?uSnap.data():{};

    list.innerHTML+=`
      <tr onclick="openProfile('${a.id}')">
        <td>${u.fullName||"-"}</td>
        <td>${u.email||"-"}</td>
        <td>${u.phone||"-"}</td>
        <td class="uid">
          ${a.id}
          <span class="copy" onclick="copy(event,'${a.id}')">copy</span>
        </td>
        <td><span class="badge">Admin</span></td>
      </tr>`;
  }
}

/* COPY UID */
window.copy=(e,uid)=>{
  e.stopPropagation();
  navigator.clipboard.writeText(uid);
  alert("UID copied");
};

/* OPEN PROFILE */
window.openProfile=uid=>{
  location.href=`admin-profile.html?uid=${uid}`;
};
</script>

</body>
</html>

