<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Admin Media Manager – Sadri Villa</title>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>

<style>
body{font-family:Arial;background:#f3f6f9;padding:30px}
.card{background:#fff;padding:22px;border-radius:18px;max-width:800px}
button{padding:10px 18px;border:none;border-radius:10px;background:#2563eb;color:#fff}
.msg{margin-top:10px;font-size:14px}
.msg.error{color:#991b1b}
.msg.success{color:#065f46}
</style>
</head>

<body>

<h2>Admin Media Manager – Sadri Villa</h2>

<div class="card">
  <input type="file" id="logoInput" accept="image/*">
  <br><br>
  <button onclick="uploadLogo()">Upload Logo</button>
  <div class="msg" id="logoMsg"></div>
</div>

<script>
firebase.initializeApp({
  apiKey: "AIzaSyC7gkT4F_dRJpWfef12y6cwV3F2PTMJ6fY",
  authDomain: "sadri-villa-14c06.firebaseapp.com",
  projectId: "sadri-villa-14c06"
});

async function uploadLogo() {
  const msg = document.getElementById("logoMsg");
  const file = document.getElementById("logoInput").files[0];
  if (!file) return;

  msg.textContent = "Uploading...";

  const user = firebase.auth().currentUser;
  const token = await user.getIdToken(true);

  const reader = new FileReader();
  reader.onload = async () => {
    const base64 = reader.result.split(",")[1];

    const res = await fetch(
      "https://uploadsiteimage-jgzkr3mifq-uc.a.run.app",
      {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
          Authorization: `Bearer ${token}`
        },
        body: JSON.stringify({
          fieldName: "logo",
          fileName: file.name,
          mimeType: file.type,
          fileBase64: base64
        })
      }
    );

    if (!res.ok) {
      msg.className = "msg error";
      msg.textContent = "Upload failed";
      return;
    }

    msg.className = "msg success";
    msg.textContent = "Logo updated successfully ✅";
  };

  reader.readAsDataURL(file);
}
</script>

</body>
</html>
