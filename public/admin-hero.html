<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Admin | Hero Images</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
* { box-sizing: border-box }

body {
  margin: 0;
  padding: 16px;
  font-family: Arial, sans-serif;
  background: #f1f5f9;
  color: #0f172a;
}

/* TOP BAR */
.top-bar {
  margin-bottom: 14px;
}

.back-btn {
  background: linear-gradient(135deg, #93c5fd, #60a5fa);
  color: #fff;
  border: none;
  padding: 8px 14px;
  border-radius: 10px;
  font-size: 14px;
  cursor: pointer;
}

/* CARD */
.hero-admin-card {
  max-width: 720px;
  margin: auto;
  background: #ffffff;
  padding: 18px;
  border-radius: 16px;
  box-shadow: 0 10px 25px rgba(0,0,0,0.08);
}

.upload-box {
  display: inline-block;
  padding: 14px 20px;
  border: 2px dashed #93c5fd;
  border-radius: 12px;
  color: #2563eb;
  cursor: pointer;
}

.btn-gradient {
  width: 100%;
  margin-top: 10px;
  padding: 12px;
  border: none;
  border-radius: 12px;
  background: linear-gradient(135deg, #60a5fa, #38bdf8);
  color: #fff;
  font-weight: 600;
  cursor: pointer;
}

.hero-images-list {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
  gap: 12px;
  margin-top: 18px;
}

.hero-card {
  background: #fff;
  border-radius: 14px;
  overflow: hidden;
  box-shadow: 0 6px 18px rgba(0,0,0,0.08);
}

.hero-card img {
  width: 100%;
  height: 120px;
  object-fit: cover;
}

.hero-card-actions {
  padding: 10px;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.delete-btn {
  background: #fee2e2;
  color: #b91c1c;
  border: none;
  padding: 6px 10px;
  border-radius: 8px;
  font-size: 13px;
  cursor: pointer;
}

/* TOGGLE */
.switch {
  position: relative;
  width: 42px;
  height: 22px;
}

.switch input { display: none }

.slider {
  position: absolute;
  inset: 0;
  background: #cbd5f5;
  border-radius: 999px;
}

.slider::before {
  content: "";
  position: absolute;
  width: 16px;
  height: 16px;
  left: 3px;
  bottom: 3px;
  background: #fff;
  border-radius: 50%;
}

.switch input:checked + .slider {
  background: linear-gradient(135deg, #60a5fa, #38bdf8);
}

.switch input:checked + .slider::before {
  transform: translateX(20px);
}
</style>
</head>

<body>

<div class="top-bar">
  <button class="back-btn" onclick="location.href='admin.html'">‚Üê Back</button>
</div>

<div class="hero-admin-card">
  <h3>üñº Hero Images</h3>

  <label class="upload-box">
    <input type="file" id="heroImagesInput" accept="image/*" multiple hidden>
    üì§ Select Images
  </label>

  <button class="btn-gradient" onclick="uploadHeroImages()">Upload Images</button>

  <p id="heroMsg"></p>

  <div id="heroImagesList" class="hero-images-list"></div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import {
  getFirestore, doc, getDoc, updateDoc,
  arrayUnion, serverTimestamp
} from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";
import {
  getStorage, ref, uploadBytes, getDownloadURL
} from "https://www.gstatic.com/firebasejs/10.7.1/firebase-storage.js";

/* üî• YOUR FIREBASE CONFIG */
const firebaseConfig = {
  apiKey: "YOUR_KEY",
  authDomain: "YOUR_DOMAIN",
  projectId: "YOUR_PROJECT_ID",
  storageBucket: "YOUR_BUCKET",
  messagingSenderId: "YOUR_SENDER_ID",
  appId: "YOUR_APP_ID"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);
const storage = getStorage(app);

const homeRef = doc(db, "siteSettings", "home");
const list = document.getElementById("heroImagesList");
const heroMsg = document.getElementById("heroMsg");

/* LOAD */
async function loadHeroImages() {
  list.innerHTML = "";
  const snap = await getDoc(homeRef);
  if (!snap.exists()) return;

  const images = snap.data().heroimages || [];

  images.forEach((img, i) => {
    const div = document.createElement("div");
    div.className = "hero-card";
    div.innerHTML = `
      <img src="${img.url}">
      <div class="hero-card-actions">
        <label class="switch">
          <input type="checkbox" ${img.enabled ? "checked" : ""}
            onchange="toggleHero(${i})">
          <span class="slider"></span>
        </label>
        <button class="delete-btn" onclick="deleteHero(${i})">Delete</button>
      </div>
    `;
    list.appendChild(div);
  });
}

/* UPLOAD */
window.uploadHeroImages = async () => {
  const files = heroImagesInput.files;
  if (!files.length) {
    heroMsg.textContent = "‚ùå Please select images";
    return;
  }

  heroMsg.textContent = "Uploading...";

  for (let file of files) {
    const refImg = ref(storage, `hero/${Date.now()}-${file.name}`);
    await uploadBytes(refImg, file);
    const url = await getDownloadURL(refImg);

    await updateDoc(homeRef, {
      heroimages: arrayUnion({
        url,
        enabled: true,
        createdAt: serverTimestamp()
      })
    });
  }

  heroMsg.textContent = "‚úÖ Images uploaded";
  heroImagesInput.value = "";
  loadHeroImages();
};

/* TOGGLE */
window.toggleHero = async (index) => {
  const snap = await getDoc(homeRef);
  const imgs = snap.data().heroimages;
  imgs[index].enabled = !imgs[index].enabled;
  await updateDoc(homeRef, { heroimages: imgs });
};

/* DELETE */
window.deleteHero = async (index) => {
  if (!confirm("Delete this image?")) return;
  const snap = await getDoc(homeRef);
  const imgs = snap.data().heroimages;
  imgs.splice(index, 1);
  await updateDoc(homeRef, { heroimages: imgs });
  loadHeroImages();
};

loadHeroImages();
</script>

</body>
</html>
